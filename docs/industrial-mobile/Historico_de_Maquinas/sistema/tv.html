<!doctype html><html lang="pt-br">
<head>
  <meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Tela TV ‚Äî MQ_01</title>
  <link rel="stylesheet" href="./assets/style.css">
  <style>
    /* Tema escuro forte para a TV */
    body{background:#0b1225;color:#e5e7eb}
    .header{background:#0b1225}
    /* Todos os cards da TV ficam escuros (inclui ‚Äú√öltimos eventos‚Äù) */
    .card{background:#111827;color:#e5e7eb;border:1px solid #1f2937}
    .k{display:grid;grid-template-columns:1fr;gap:1rem}
    @media(min-width:900px){.k{grid-template-columns:repeat(3,1fr)}}
    /* Texto dos eventos mais leg√≠vel */
    .events .card b{color:#93c5fd}           /* data com leve destaque azul */
    .events .card span.status{font-weight:600}
  </style>
</head>
<body>
  <div class="header">
    <h1>üì∫ TV ‚Äî MQ_01</h1>
    <nav><a href="./fabrica.html">F√°brica</a> <a href="./index.html">Dashboard</a></nav>
  </div>

  <div class="container">
    <div class="k">
      <div class="card"><b>Abertos</b><div id="tv_abertos" style="font-size:2.2rem">-</div></div>
      <div class="card"><b>Atrasados</b><div id="tv_atraso" style="font-size:2.2rem">-</div></div>
      <div class="card"><b>Pr√≥ximo prazo</b><div id="tv_prazo" style="font-size:2.2rem">-</div></div>
    </div>

    <h3 style="margin-top:1rem">√öltimos eventos</h3>
    <div id="tv_hist" class="events"></div>
  </div>

  <div class="footer">Desenvolvido por Marcos Gar√ßon P de Oliveira</div>

  <script>
    const DATA_BASE = "../Setor%20-XY/MQ_01";
    async function tick(){
      try{
        const r = await fetch(`${DATA_BASE}/dados.json`, {cache:'no-store'});
        const d = await r.json();
        const hist = d.historico || [];

        const abertos = hist.filter(h=>h.status==='Aberto').length;
        const atrasados = hist.filter(h=>h.status==='Aberto' && h.prazo && new Date(h.prazo) < new Date()).length;
        const prox = hist.map(h=>h.prazo).filter(Boolean).sort()[0] || '-';
        tv_abertos.textContent = abertos;
        tv_atraso.textContent = atrasados;
        tv_prazo.textContent = prox;

        // Render eventos com alto contraste
        tv_hist.innerHTML = '';
        hist.slice(-6).reverse().forEach(h=>{
          const color = (h.status==='Aberto') ? '#f59e0b' : '#22c55e'; // laranjA/verde mais vivos
          tv_hist.insertAdjacentHTML('beforeend', `
            <div class="card" style="border-left:6px solid ${color}">
              <b>${h.data || '-'}</b> ‚Äî ${h.descricao || '-'} ‚Äî <span class="status">${h.status || '-'}</span>
              ${h.prazo ? ` ‚Äî Prazo: <span class="status">${h.prazo}</span>` : ''}
            </div>
          `);
        });
      }catch(e){
        // silencioso para TV
      }
    }
    tick();
    setInterval(tick, 30000);
  </script>
</body>
</html>
