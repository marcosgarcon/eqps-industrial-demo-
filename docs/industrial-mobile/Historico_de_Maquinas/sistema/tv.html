<!doctype html><html lang="pt-br"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>Tela TV â€” MQ_01</title>
<link rel="stylesheet" href="./assets/style.css">
<style>
  body{background:#0b1225;color:#e5e7eb}
  .header{background:#0b1225}
  .k{display:grid;grid-template-columns:1fr;gap:1rem}
  @media(min-width:900px){.k{grid-template-columns:repeat(3,1fr)}}
  .k .card{background:#111827;border:1px solid #1f2937}
</style>
</head><body>
  <div class="header">
    <h1>ðŸ“º TV â€” MQ_01</h1>
    <nav><a href="./fabrica.html">FÃ¡brica</a> <a href="./index.html">Dashboard</a></nav>
  </div>

  <div class="container">
    <div class="k">
      <div class="card"><b>Abertos</b><div id="tv_abertos" style="font-size:2.2rem">-</div></div>
      <div class="card"><b>Atrasados</b><div id="tv_atraso" style="font-size:2.2rem">-</div></div>
      <div class="card"><b>PrÃ³ximo prazo</b><div id="tv_prazo" style="font-size:2.2rem">-</div></div>
    </div>
    <h3>Ãšltimos eventos</h3>
    <div id="tv_hist"></div>
  </div>

  <div class="footer">Desenvolvido por Marcos GarÃ§on P de Oliveira</div>

  <script>
    const DATA="../Setor%20-XY/MQ_01";
    async function tick(){
      try{
        const r=await fetch(`${DATA}/dados.json`,{cache:'no-store'}); const d=await r.json();
        const hist=d.historico||[];
        tv_abertos.textContent=hist.filter(h=>h.status==='Aberto').length;
        tv_atraso.textContent=hist.filter(h=>h.status==='Aberto'&&h.prazo&&new Date(h.prazo)<new Date()).length;
        tv_prazo.textContent=hist.map(h=>h.prazo).filter(Boolean).sort()[0]||'-';
        tv_hist.innerHTML=''; hist.slice(-6).reverse().forEach(h=>{
          const c=(h.status==='Aberto')?'#f59e0b':'#10b981';
          tv_hist.insertAdjacentHTML('beforeend', `<div class="card" style="border-left:6px solid ${c}"><b>${h.data}</b> â€” ${h.descricao} â€” ${h.status}</div>`);
        });
      }catch(e){}
    }
    tick(); setInterval(tick,30000);
  </script>
</body></html>
